---
phase: 11-polish-testing-launch
plan: 05
type: execute
wave: 2
depends_on: ["11-01"]
files_modified:
  - apps/web/app/(public)/terms/page.tsx
  - apps/web/app/(public)/privacy/page.tsx
  - apps/web/app/(public)/help/page.tsx
  - apps/web/app/(app)/donate/page.tsx
  - apps/web/components/invite-friends.tsx
  - apps/web/app/(app)/settings/page.tsx
  - apps/web/app/(app)/profile/page.tsx
  - apps/web/__tests__/launch-pages.test.ts
autonomous: true

must_haves:
  truths:
    - "Terms of service page is accessible at /terms"
    - "Privacy policy page is accessible at /privacy"
    - "Help/FAQ page is accessible at /help with common questions"
    - "Donation prompt exists as a page with external donation link"
    - "User can share an invite link to the app"
    - "App store metadata descriptions exist for iOS and Google Play"
  artifacts:
    - path: "apps/web/app/(public)/terms/page.tsx"
      provides: "Terms of service page"
    - path: "apps/web/app/(public)/privacy/page.tsx"
      provides: "Privacy policy page"
    - path: "apps/web/app/(public)/help/page.tsx"
      provides: "Help/FAQ page"
    - path: "apps/web/app/(app)/donate/page.tsx"
      provides: "Donation prompt page"
    - path: "apps/web/components/invite-friends.tsx"
      provides: "Invite friends share component"
      contains: "InviteFriends"
    - path: "apps/web/__tests__/launch-pages.test.ts"
      provides: "Tests for legal and launch pages"
  key_links:
    - from: "apps/web/app/(app)/settings/page.tsx"
      to: "apps/web/app/(public)/terms/page.tsx"
      via: "Settings legal link navigates to /terms"
      pattern: "router.push.*terms"
    - from: "apps/web/app/(app)/settings/page.tsx"
      to: "apps/web/app/(public)/help/page.tsx"
      via: "Settings help link navigates to /help"
      pattern: "router.push.*help"
---

<objective>
Create app store assets, legal pages (ToS, privacy), help/FAQ, donation prompt, and invite-friends flow.

Purpose: PLAT-03 (legal pages), PLAT-04 (donation), PLAT-08 (help/FAQ), PLAT-09 (invite friends), and PLAT-16 (app store assets) complete the launch preparation. Legal pages are required for app store submission. Help/FAQ reduces support burden.

Output: Terms of service, privacy policy, help/FAQ pages, donation page, invite-friends component, app store metadata, unit tests.
</objective>

<execution_context>
@/Users/miakh/.claude/get-shit-done/workflows/execute-plan.md
@/Users/miakh/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@apps/web/app/(public)/ride/[shortId]/page.tsx
@apps/web/app/(app)/settings/page.tsx
@packages/shared/src/constants/seo.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Legal pages (ToS, privacy), help/FAQ, donation page, and invite-friends component</name>
  <files>
    apps/web/app/(public)/terms/page.tsx
    apps/web/app/(public)/privacy/page.tsx
    apps/web/app/(public)/help/page.tsx
    apps/web/app/(app)/donate/page.tsx
    apps/web/components/invite-friends.tsx
    apps/web/app/(app)/settings/page.tsx
    apps/web/app/(app)/profile/page.tsx
  </files>
  <action>
1. Create `apps/web/app/(public)/terms/page.tsx`:
   - Server component (no "use client")
   - Export metadata for SEO: title "Terms of Service | Festapp Rideshare"
   - Prose-styled content using Tailwind typography classes (prose prose-lg max-w-3xl mx-auto py-12 px-4)
   - Sections:
     - Introduction: Festapp Rideshare is a free carpooling platform connecting drivers and passengers
     - Eligibility: Must be 18+, valid driver's license for drivers
     - User responsibilities: Accurate profile info, safe driving, respectful behavior
     - Ride agreements: Rides are between users, platform is not a party to the agreement
     - Cost sharing: Prices are suggestions for fuel cost sharing only, not commercial transport
     - Cancellations: Users should cancel with reasonable notice
     - Content and conduct: No harassment, spam, illegal activity
     - Privacy: Links to /privacy
     - Liability: Platform is not liable for incidents during rides
     - Changes: Terms may be updated, continued use constitutes acceptance
     - Contact: support@rideshare.festapp.com (placeholder)
   - Last updated date: February 2026
   - Written in English (i18n can translate later, legal text needs professional review anyway)

2. Create `apps/web/app/(public)/privacy/page.tsx`:
   - Server component, SEO metadata: "Privacy Policy | Festapp Rideshare"
   - Same prose styling as terms page
   - Sections:
     - What data we collect: Profile info, ride history, chat messages, location (when sharing), device info
     - How we use it: Matching riders, notifications, platform improvement
     - Data sharing: We don't sell data, share only with ride participants as needed
     - Data storage: Hosted on Supabase (AWS eu-central-1), encrypted at rest
     - Cookies: Analytics cookies (optional, consent-based), auth session cookies (necessary)
     - Your rights (GDPR): Access, rectification, erasure, data portability, objection
     - Data export: Available from Settings > Export My Data
     - Data deletion: Available from Settings > Delete Account
     - Third-party services: Supabase, OneSignal (push), Sentry (errors), Google Maps
     - Children: Not intended for users under 18
     - Contact: Data protection contact email (placeholder)
   - Last updated: February 2026

3. Create `apps/web/app/(public)/help/page.tsx`:
   - Server component, SEO metadata: "Help & FAQ | Festapp Rideshare"
   - Accordion-style FAQ using details/summary HTML elements (no JS needed)
   - Categories with 3-4 questions each:
     - **Getting Started**: How do I create an account? How do I post a ride? How do I find a ride?
     - **Booking**: How does instant booking work? How does request-and-approve work? How do I cancel a booking?
     - **Safety**: How is the platform safe? What are verification badges? How do I report a user?
     - **Payments**: Is the platform free? How are prices calculated? How do I pay the driver?
     - **Account**: How do I edit my profile? How do I delete my account? How do I export my data?
   - Contact section at bottom: "Still have questions? Email us at support@rideshare.festapp.com"
   - Style details/summary: rounded-xl bg-surface border, summary cursor-pointer py-3 px-4, open state with answer in px-4 pb-3

4. Create `apps/web/app/(app)/donate/page.tsx`:
   - "use client" for share functionality
   - Title: "Support Festapp Rideshare"
   - Description: "Festapp Rideshare is completely free. If you find it useful, consider buying us a coffee to help keep it running."
   - Coffee cup icon (lucide-react Coffee icon)
   - External link button: "Buy Us a Coffee" → opens https://ko-fi.com/festapp (placeholder URL, opens in new tab)
   - Secondary text: "Every contribution helps cover server costs and keeps the platform free for everyone."
   - Card style: bg-surface, rounded-2xl, shadow-sm, centered, max-w-md

5. Create `apps/web/components/invite-friends.tsx`:
   - "use client" directive
   - Export `InviteFriends` component
   - Uses navigator.share API (with clipboard fallback, matching existing ShareButton pattern from 08-05)
   - Share data: title "Join Festapp Rideshare", text "Find shared rides easily. Join me on Festapp Rideshare!", url SITE_URL from @festapp/shared
   - Renders as a button: "Invite Friends" with lucide-react Share2 icon
   - Props: `variant?: 'button' | 'link'` — button is primary styled, link is text-only
   - On success: toast "Link copied!" or share sheet opens

6. Update `apps/web/app/(app)/settings/page.tsx`:
   - Update Legal onClick: `router.push("/terms")` (was alert)
   - Update Help onClick: `router.push("/help")` (was alert)
   - Add "Invite Friends" item to the Info section (renders InviteFriends as inline, or navigates to share)
   - Add "Support Us" item to the Info section that navigates to `/donate`
   - Keep existing items, just update the placeholder alert()s to real routes

7. Update `apps/web/app/(app)/profile/page.tsx` (if it exists):
   - Add InviteFriends button somewhere on the profile page (e.g., below the user's info section)
   - If profile page structure doesn't easily accommodate it, skip this and just keep it in settings
  </action>
  <verify>
   - /terms page renders with legal content
   - /privacy page renders with privacy policy
   - /help page renders FAQ with expandable sections
   - /donate page renders with external link
   - InviteFriends component shares the app URL
   - Settings page links to all new pages
  </verify>
  <done>
   - Terms of service at /terms with comprehensive sections
   - Privacy policy at /privacy with GDPR-compliant disclosures
   - Help/FAQ at /help with accordion-style questions
   - Donation page at /donate with external coffee link
   - Invite friends component with Web Share API + clipboard fallback
   - Settings page updated with real navigation to all pages
  </done>
</task>

<task type="auto">
  <name>Task 2: App store metadata and unit tests</name>
  <files>
    apps/web/public/store-metadata.json
    apps/web/__tests__/launch-pages.test.ts
  </files>
  <action>
1. Create `apps/web/public/store-metadata.json`:
   - Structured JSON with metadata for both app stores:
   ```json
   {
     "ios": {
       "name": "Festapp Rideshare",
       "subtitle": "Free community carpooling",
       "description": "Find and share rides with people going your way. Festapp Rideshare connects drivers with empty seats to passengers heading the same direction. Post a ride as a driver or search for one as a passenger — it's completely free.\n\nFeatures:\n- Post and search rides with smart route matching\n- Real-time chat with your ride companions\n- Live location sharing for easy pickup\n- Events with dedicated ride listings\n- Impact dashboard showing your CO2 savings\n- Achievement badges and levels\n- AI assistant for hands-free ride booking\n\nSafe & Trustworthy:\n- Verified profiles with phone and ID checks\n- Ratings and reviews after every ride\n- Driver reliability scores\n- Report and block features\n\nAvailable in Czech, Slovak, and English.",
       "keywords": "rideshare,carpooling,spolujizda,ridesharing,festapp,travel,rides,community",
       "category": "Travel",
       "screenshots": ["screenshot-search.png", "screenshot-ride-detail.png", "screenshot-chat.png", "screenshot-profile.png", "screenshot-impact.png"],
       "privacy_url": "https://rideshare.festapp.com/privacy",
       "support_url": "https://rideshare.festapp.com/help"
     },
     "android": {
       "name": "Festapp Rideshare",
       "short_description": "Free community carpooling — find and share rides",
       "full_description": "Find and share rides with people going your way. Festapp Rideshare connects drivers with empty seats to passengers heading the same direction.\n\nWhether you're commuting to work, heading to a festival, or traveling between cities, Festapp Rideshare makes it easy to find a ride or offer one.\n\nKey Features:\n★ Smart Search — Find rides near your route with geospatial matching\n★ Post a Ride — Share your journey and split fuel costs\n★ Real-time Chat — Coordinate with passengers and drivers\n★ Live Location — Share your position for easy pickup\n★ Events — Create events and find rides to them\n★ Impact Dashboard — Track your CO2 savings\n★ Badges & Levels — Earn achievements for sharing rides\n★ AI Assistant — Book rides with natural language\n\nSafety Features:\n✓ Phone and ID verification\n✓ Ratings and reviews\n✓ Report and block users\n✓ Driver reliability scores\n\nCompletely free. No commissions. No hidden fees.\n\nAvailable in Czech, Slovak, and English.",
       "category": "Maps & Navigation",
       "tags": ["rideshare", "carpooling", "travel", "community", "spolujizda"],
       "privacy_policy": "https://rideshare.festapp.com/privacy",
       "content_rating": "Everyone"
     }
   }
   ```

2. Create `apps/web/__tests__/launch-pages.test.ts`:
   - Test store-metadata.json: file exists and is valid JSON, has ios and android sections, both have name/description/privacy_url or privacy_policy
   - Test store metadata: descriptions are under character limits (iOS description < 4000 chars, Android short_description < 80 chars, Android full_description < 4000 chars)
   - Test store metadata: iOS keywords are comma-separated and under 100 chars total
   - Test terms page: file exists at app/(public)/terms/page.tsx (verify file on disk)
   - Test privacy page: file exists at app/(public)/privacy/page.tsx
   - Test help page: file exists at app/(public)/help/page.tsx
   - Test version.json: exists and has minVersion and latestVersion fields (from plan 03)
   - Test SITE_URL constant is a valid URL
   - At least 8 test cases
   - Read files using fs for file existence checks, parse JSON for metadata validation
  </action>
  <verify>
   - `cd apps/web && npx vitest run __tests__/launch-pages.test.ts` — all tests pass
   - store-metadata.json is valid and contains all required fields
  </verify>
  <done>
   - App store metadata JSON covers both iOS and Android with descriptions, keywords, and links
   - 8+ unit tests validate store metadata structure and page existence
  </done>
</task>

</tasks>

<verification>
- /terms, /privacy, /help pages render with proper content
- /donate page has external link to Ko-fi
- InviteFriends uses Web Share API with clipboard fallback
- Settings page navigates to all new pages (no more alert() placeholders)
- Store metadata JSON has valid content for both platforms
- Tests pass: `cd apps/web && npx vitest run __tests__/launch-pages.test.ts`
</verification>

<success_criteria>
- PLAT-03 satisfied: Terms of service and privacy policy pages exist
- PLAT-04 satisfied: Donation prompt page with external link
- PLAT-08 satisfied: Help/FAQ page with common questions
- PLAT-09 satisfied: Invite friends component with share functionality
- PLAT-16 satisfied: App store descriptions and metadata for iOS and Android
- 8+ unit tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/11-polish-testing-launch/11-05-SUMMARY.md`
</output>
