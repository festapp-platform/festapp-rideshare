---
phase: 16-ui-polish-route-features
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/app/(app)/components/map-location-picker.tsx
  - apps/web/app/(app)/components/ride-form.tsx
  - apps/web/app/(app)/components/star-rating.tsx
  - apps/web/app/(app)/impact/impact-dashboard.tsx
  - packages/shared/src/i18n/translations/cs.ts
  - packages/shared/src/i18n/translations/sk.ts
  - packages/shared/src/i18n/translations/en.ts
autonomous: true
requirements:
  - UX-01
  - UX-02
  - UX-03
  - UX-04

must_haves:
  truths:
    - "Map location picker opens zoomed to already-selected coordinates (zoom ~14) instead of default Czech Republic view"
    - "Users with no ratings show a localized 'Novy' badge instead of English 'New'"
    - "Money Saved stat card is not visible on the impact dashboard"
    - "Price slider value already displays below the slider (UX-04 done in Phase 14)"
  artifacts:
    - path: "apps/web/app/(app)/components/map-location-picker.tsx"
      provides: "MapLocationPicker with optional initialLat/initialLng props"
      contains: "initialLat"
    - path: "apps/web/app/(app)/components/star-rating.tsx"
      provides: "Localized 'New' badge via t() function"
      contains: "useI18n"
    - path: "apps/web/app/(app)/impact/impact-dashboard.tsx"
      provides: "Impact dashboard without Money Saved card"
  key_links:
    - from: "apps/web/app/(app)/components/ride-form.tsx"
      to: "apps/web/app/(app)/components/map-location-picker.tsx"
      via: "initialLat/initialLng props passed from origin/destination state"
      pattern: "initialLat.*initialLng"
    - from: "apps/web/app/(app)/components/star-rating.tsx"
      to: "packages/shared/src/i18n/translations/cs.ts"
      via: "t('common.newUser') translation key"
      pattern: "common\\.newUser"
---

<objective>
Fix three UI polish items: (1) map location picker zooms to existing coordinates, (2) star rating shows localized "Novy" badge, (3) remove Money Saved from impact dashboard. UX-04 (price slider) is already done -- verify only.

Purpose: Resolve visual polish issues reported during v1.0 usage testing.
Output: Three modified components with improved UX behavior.
</objective>

<execution_context>
@/Users/miakh/.claude/get-shit-done/workflows/execute-plan.md
@/Users/miakh/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/16-ui-polish-route-features/16-RESEARCH.md
@apps/web/app/(app)/components/map-location-picker.tsx
@apps/web/app/(app)/components/ride-form.tsx
@apps/web/app/(app)/components/star-rating.tsx
@apps/web/app/(app)/impact/impact-dashboard.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Map picker initial zoom + StarRating localization + Money Saved removal</name>
  <files>
    apps/web/app/(app)/components/map-location-picker.tsx
    apps/web/app/(app)/components/ride-form.tsx
    apps/web/app/(app)/components/star-rating.tsx
    apps/web/app/(app)/impact/impact-dashboard.tsx
    packages/shared/src/i18n/translations/cs.ts
    packages/shared/src/i18n/translations/sk.ts
    packages/shared/src/i18n/translations/en.ts
  </files>
  <action>
    **UX-01: Map location picker initial zoom**

    1. In `map-location-picker.tsx`, add optional `initialLat?: number` and `initialLng?: number` props to the component interface/props type.
    2. In the useEffect where `L.map()` is created (currently hardcoded `center: [49.8, 15.5], zoom: 7`):
       - If `initialLat` and `initialLng` are both provided, use `center: [initialLat, initialLng]` with `zoom: 14`.
       - Otherwise, fall back to the existing default `[49.8, 15.5]` with zoom 7.
       - Also place an initial marker at the `initialLat/initialLng` position if provided, so the user sees the current selection.
    3. In `ride-form.tsx`, find the `<MapLocationPicker>` usage (around line 870-875). Pass `initialLat` and `initialLng` based on the `showMapPicker` state:
       - If `showMapPicker === "origin"` and origin has coordinates, pass `initialLat={origin.lat}` `initialLng={origin.lng}`.
       - If `showMapPicker === "destination"` and destination has coordinates, pass `initialLat={destination.lat}` `initialLng={destination.lng}`.
       - Use optional chaining since origin/destination may not have coordinates yet.

    **UX-02: StarRating "Novy" badge localization**

    1. In `star-rating.tsx`, import `useI18n` from the project's i18n system (check existing components like ride-detail.tsx for the import pattern).
    2. Get `const { t } = useI18n();` at the top of the component.
    3. Replace the hardcoded `New` text (in the badge span for rating === 0 && count === 0) with `{t("common.newUser")}`.
    4. Add translation key `common.newUser` to all three translation files:
       - cs.ts: `"common.newUser": "Novy"`
       - sk.ts: `"common.newUser": "Novy"`
       - en.ts: `"common.newUser": "New"`

    **UX-03: Remove Money Saved from impact dashboard**

    1. In `impact-dashboard.tsx`, find and remove the entire `<StatCard>` block that shows "Money Saved" (uses `Wallet` icon and `formatPrice(impact?.total_money_saved_czk ?? 0)`). Remove around lines 147-152.
    2. Also remove the `Wallet` import from lucide-react if it's no longer used elsewhere in the file.
    3. Check if `total_money_saved_czk` is referenced elsewhere in the file (e.g., in the fetch query) -- leave the query as-is (don't break the RPC), just don't render the card.

    **UX-04: Verify already done**

    Confirm that the price slider in ride-form.tsx already shows the value below the slider (done in Phase 14 as PRICE-03). No code changes needed -- just visually verify the pattern exists in the code.
  </action>
  <verify>
    1. `npx tsc --noEmit` passes without errors in the web app.
    2. Grep for `initialLat` in map-location-picker.tsx confirms the prop exists.
    3. Grep for `common.newUser` in star-rating.tsx and all three translation files confirms localization.
    4. Grep for `Money Saved` or `total_money_saved_czk` in impact-dashboard.tsx JSX confirms it's removed from the rendered output.
    5. Grep for the price slider value display pattern in ride-form.tsx confirms UX-04 is already in place.
  </verify>
  <done>
    Map picker opens at zoom 14 centered on existing coordinates when available. StarRating shows "Novy"/"Novy"/"New" based on locale. Money Saved card removed from impact dashboard. UX-04 confirmed already done.
  </done>
</task>

</tasks>

<verification>
- TypeScript compiles without errors
- All three translation files have the `common.newUser` key
- No regressions in map-location-picker (still works when no initial coordinates)
- impact-dashboard renders without the Money Saved StatCard
</verification>

<success_criteria>
- MapLocationPicker accepts and uses initialLat/initialLng props
- ride-form.tsx passes coordinates to MapLocationPicker
- StarRating displays localized badge text
- Money Saved StatCard removed from impact dashboard
- UX-04 confirmed present from Phase 14
</success_criteria>

<output>
After completion, create `.planning/phases/16-ui-polish-route-features/16-01-SUMMARY.md`
</output>
